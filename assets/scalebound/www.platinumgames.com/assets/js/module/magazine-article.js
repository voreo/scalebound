/*!
 *
 * magazine-article.js
 *
 */
var App=App||{};!function(){function e(){var e=[],n=jQuery.Deferred(),t=$(".js-float-item-container");return t.each(function(o,i){var a=$(i).find(".js-float-item");return 0===a.length?n.promise():(e.push({flag:!0,posY:$(i).offset().top,posX:$(i).offset().left+$(i).width(),height:$(i).height(),element:$(i),paddingBottom:$(i).css("padding-bottom"),box:{element:a,posX:+a.css("right").replace("px",""),posY:a.offset().top,top:+a.css("top").replace("px",""),left:+a.css("left").replace("px",""),height:a.height()}}),void(t.length==e.length&&n.resolve(e)))}),n.promise()}function n(e){for(var n=t.scrollTop(),o=0,i=e.length;i>o;o++)e[o].height=e[o].element.height(),n<e[o].posY&&(e[o].element.removeClass("old now"),e[o].box.element.attr("style","")),n>e[o].posY+20&&n<e[o].posY+e[o].height-e[o].box.height?(e[o].element.removeClass("old").addClass("now"),e[o].box.element.css({left:e[o].posX-e[o].box.element.width(),top:e[o].box.top})):n>e[o].posY+e[o].height-e[o].box.height&&(e[o].element.removeClass("now").addClass("old"),e[o].box.element.attr("style",""))}var t=$(window),o=function(){var t,o,i,a,s=function(){$(".page-magazine-single").length&&(t=$(window),i=location.hostname,a="www.platinumgames.co.jp",r(),setTimeout(function(){l(),t.resize(function(o){e().done(function(e){n(e),t.on("scroll",function(t){n(e)})})})},250))},l=function(){void 0===o?(o=$.ias({container:".js-magazine-post-container",item:".js-magazine-post",pagination:".js-magazine-pagenav",next:".js-magazine-pagenav .js-next",negativeMargin:300,delay:0}),o.extension(new IASNoneLeftExtension({text:""}))):$.ias().reinitialize(),o.on("load",function(e){var n=e.url,t=jQuery("<a/>").attr("href",n)[0].pathname.replace(/^[^\/]/,"/");"undefined"!=typeof ga&&ga("send",{hitType:"pageview",page:t,location:n})}),o.on("render",function(e){$(e).fitVids(),setTimeout(r,100)}),o.on("scroll",function(o){e().done(function(e){n(e),t.on("scroll",function(t){n(e)})})}),o.on("noneLeft",function(){})},r=function(){var o=$('.js-magazine-post:not(".onscreen")');o.each(function(e){$(this).addClass("onscreen")}),e().done(function(e){n(e),t.on("scroll",function(t){n(e)})})};return{initialize:s}}();App.infiniteAjaxScroll=o,App.infiniteAjaxScroll.initialize()}();